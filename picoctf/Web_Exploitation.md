# 1. Web Gauntlet
> Log into http://shape-facility.picoctf.net:60454/index.php as the admin using SQL injections in rounds to get the flag.

## Solution:
- The site is a login page where we can enter username and password. Usually such sites can be accessed using SQL injection with admin or 1=1 commands.
- The filter page showed the words/characters blocked by the site. So keeping those in mind gave admin'-- injection because 'or' was blocked.
- Round 2 blocked and, like,=,--. Next injection- admin' /*.
- Round 3 blocked ><. Next- admin';.
- Round 4 blocked admin. Next- ad'||'min';. Used concatenation operator to make the word 'admin'.
- Round 5 blocked union but the previous injection still worked.
- The complete source code was on the filter page with the flag at the end as comment.
<img width="1920" height="1080" alt="Screenshot (141)" src="https://github.com/user-attachments/assets/86645acb-24c7-4e5a-85a0-21d9111787cd" />

##  Flag:
```
picoCTF{y0u_m4d3_1t_79a0ddc6}
```
## Concepts Learnt:
- SQL injection can be done when a site asks for user input, like their username/userid, and instead of a name/id, an SQL statement can be run unknowingly on database.
- The SQL injection 1=1 is valid and will return all values, since OR 1=1 is always true. This can give access to such sites without the need of passwords.

## Notes:
- I did not understand the purpose of the filter page, and therefore tried to use 'or' with admin and 1=1 in round 1. But when that didn't give me access, I read the address of the page along with the given hints and realised that it indicated the filters blocked for the round.

## Resources:

- https://www.w3schools.com/sql/sql_injection.asp

# 2. SSTI1
> Website http://rescued-float.picoctf.net:56154/ where you can announce whatever you want. Use the interface to get the flag.

## Solution:
- Usual primitive vulnerability, also taking from the title, SSTI can be used to work the site like a terminal.
- Check {{7*7}} as input, if output=49, SSTI vulnerability.
- Within SSTI, for different templates there are different ouputs.
- {{7*'7'}} gives 7777777 which confirms Jinja2 template.
- Giving python suitable payloads due to Jinja2 template, use ls command to list all files:-
  ```
  {{ request.application.__globals__.__builtins__.__import__('os').popen('ls').read() }}.
  ```
- Got this output
  <img width="1920" height="1080" alt="Screenshot (142)" src="https://github.com/user-attachments/assets/884e62ba-ddb3-4ea8-9038-7b1193bd4e96" />
- Used cat command to get the flag:-
  ```
  {{ request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read() }}
  ```
- This gave the flag
## Flag:
```
picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_09365533}
```
## Concepts Learnt:
- Server-side template injection attack (SSTI) is when a template’s native syntax is exploited and injected with malicious payloads.
- Template could be Jinja2, Twig or ERB.
- {{7*7}} gives error in ERB and 49 in rest.
- {{7*’7’}} reults in 7777777 in Jinja2 and 49 in Twig and error in ERB.
- ERB gives output 49 for <%=7*7%> and rest give error.
- For payload format- `{{ request.application.__globals__.__builtins__.__import__('os').popen('ls').read() }}` 'request' is a global object, 'applications' is a property of the global object.
- 'globals' accesses all the variables of request.application global object.
- 'builtins' all of Python's built-in functions, such as print(), len(), and import.
- The 'os' module is a standard Python library for interacting with the operating system like reading files and running commands.
- .popen() opens a pipe to or from a shell command i.e. it executes a command on the server's command line.
- .read() reads the entire output from that pipe as a single string.
## Notes: 
- I was aware of {{7*7}} giving 49 to check for SSTI vulnerabiliy. For this challenge, I searched to find out templates of SSTI and use different tests for each template.
## Resources:
- https://www.imperva.com/learn/application-security/server-side-template-injection-ssti/
- https://www.yeswehack.com/learn-bug-bounty/server-side-template-injection-exploitation
